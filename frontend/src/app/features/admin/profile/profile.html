<div class="flex justify-center p-4">
    <p-toast></p-toast>
    <div class="w-full max-w-2xl">
        <p-card header="Mi Perfil" styleClass="shadow-lg rounded-2xl overflow-hidden">
            <div class="flex flex-col items-center mb-6">
                <div class="relative group">
                    <p-avatar
                        [image]="user.previewUrl || (user.profile_photo_path ? 'http://localhost:8000/storage/' + user.profile_photo_path : 'https://primefaces.org/cdn/primeng/images/demo/avatar/amyelsner.png')"
                        size="xlarge" shape="circle"
                        styleClass="w-32 h-32 border-4 border-white shadow-md mb-4 object-cover" />

                    <div
                        class="absolute inset-0 bg-black/50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer overflow-hidden">
                        <p-fileUpload mode="basic" chooseLabel=" " chooseIcon="pi pi-camera" name="image"
                            accept="image/*" maxFileSize="5000000" (onSelect)="onFileSelect($event)" [auto]="true"
                            styleClass="p-button-rounded p-button-text text-white"></p-fileUpload>
                    </div>
                </div>
                <h2 class="text-2xl font-bold text-gray-800">{{ user.name }}</h2>
                <p class="text-gray-500">{{ user.email }}</p>
                <span
                    class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full mt-2 uppercase font-semibold tracking-wide">{{
                    user.role }}</span>
            </div>

            <div class="grid grid-cols-1 gap-6">
                <div class="field">
                    <label for="name" class="block font-medium text-gray-700 mb-2">Nombre Completo</label>
                    <span class="p-input-icon-left w-full">
                        <i class="pi pi-user"></i>
                        <input type="text" pInputText id="name" [(ngModel)]="user.name" class="w-full"
                            placeholder="Tu nombre" />
                    </span>
                </div>

                <div class="field">
                    <label for="email" class="block font-medium text-gray-700 mb-2">Correo Electrónico</label>
                    <span class="p-input-icon-left w-full">
                        <i class="pi pi-envelope"></i>
                        <input type="email" pInputText id="email" [(ngModel)]="user.email" class="w-full"
                            placeholder="tu@email.com" />
                    </span>
                </div>

                <div class="field">
                    <label for="password" class="block font-medium text-gray-700 mb-2">Nueva Contraseña</label>
                    <p-password id="password" [(ngModel)]="user.password" [toggleMask]="true" [feedback]="true"
                        placeholder="Dejar en blanco para mantener la actual" styleClass="w-full"
                        inputStyleClass="w-full"></p-password>
                </div>
            </div>

            <ng-template pTemplate="footer">
                <div class="flex justify-between items-center mt-4 pt-4 border-t border-gray-100">
                    <p-button label="Cerrar Sesión" icon="pi pi-sign-out" severity="danger" [text]="true"
                        (onClick)="logout()" />
                    <p-button label="Guardar Cambios" icon="pi pi-check" [loading]="loading"
                        (onClick)="saveProfile()" />
                </div>
            </ng-template>
        </p-card>
    </div>
</div>