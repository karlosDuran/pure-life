<div class="card">
    <p-toast></p-toast>

    <h5 class="text-xl font-bold text-gray-800 mb-4">Gesti√≥n de Roles</h5>

    <p-table [value]="roles" [tableStyle]="{'min-width': '50rem'}" [loading]="loading">
        <ng-template pTemplate="header">
            <tr>
                <th>Rol</th>
                <th>Cantidad de Usuarios</th>
                <th>Acciones</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-role>
            <tr>
                <td>
                    <p-tag [value]="role.name" [severity]="getSeverity(role.code)" class="text-lg"></p-tag>
                </td>
                <td class="text-lg font-semibold">{{ role.count }}</td>
                <td>
                    <button pButton pRipple icon="pi pi-eye" class="p-button-rounded p-button-info p-button-outlined"
                        (click)="showUsers(role)" pTooltip="Ver Usuarios" tooltipPosition="top"></button>
                </td>
            </tr>
        </ng-template>
    </p-table>

    <p-dialog [(visible)]="userDialog" [style]="{width: '600px'}" [header]="'Usuarios: ' + selectedRoleName"
        [modal]="true" styleClass="p-fluid rounded-xl" [draggable]="false" [resizable]="false">
        <ng-template pTemplate="content">
            <p-table [value]="selectedRoleUsers" [paginator]="true" [rows]="5" styleClass="p-datatable-sm">
                <ng-template pTemplate="header">
                    <tr>
                        <th>Nombre</th>
                        <th>Email</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-user>
                    <tr>
                        <td>{{ user.name }}</td>
                        <td>{{ user.email }}</td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="2" class="text-center p-4">No hay usuarios en este rol.</td>
                    </tr>
                </ng-template>
            </p-table>
        </ng-template>
        <ng-template pTemplate="footer">
            <button pButton pRipple label="Cerrar" icon="pi pi-times" class="p-button-text"
                (click)="userDialog = false"></button>
        </ng-template>
    </p-dialog>
</div>